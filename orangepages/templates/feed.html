<!DOCTYPE html>
<html class="no-js" lang="en">

<body>

    <head>
        <title>Orange Pages</title>
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800">
        <link rel='stylesheet' href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="/static/css/bootstrap.css" type="text/css" />
        <link rel="stylesheet" href="/static/css/styles.css" type="text/css" />
        <link rel="stylesheet" href="/static/css/sticky-footer-navbar.css" rel="stylesheet" />
        <link rel="stylesheet" href="/static/css/feed.css" type="text/css" />
        <link rel="stylesheet" href="/static/css/create-profile.css" type="text/css" />
        <link rel="stylesheet" href="/static/css/bootstrap-tagsinput.css">
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.12/dist/css/bootstrap-select.min.css">

        <script type="text/javascript" src="/static/js/timestamp.js"></script>
        <script>
            // Material Select Initialization
            $(document).ready(function () {
                $('.mdb-select').materialSelect();
            });
        </script>

    </head>

    {% include 'navbar.html' %}
    <!-- Create a post -->
    <form action="create-post" method="post" enctype="multipart/form-data">
        <div class="make-post container rounded">
            <div class="card-body">
                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade show active" id="posts" role="tabpanel" aria-labelledby="posts-tab">
                        <div class="form-group">
                            <label class="sr-only" for="message">post</label>
                            <textarea name="content" class="form-control" id="message" rows="3"
                                placeholder="write a post"></textarea>
                            <br>
                            <input name="tags" data-role="tagsinput" id="tags" class="form-control noEnterSubmit"
                                placeholder="enter some tags"></input>
                              <!-- @frontend -->
                              <!-- <div class="form-group"> -->
                              <br />
                                <div class="custom-file">
                                  <input type="file" class="custom-file-input" name="image" id="image">
                                  <label class="custom-file-label" for="image">Select image</label>
                                </div>
                              <!-- </div> -->
                        </div>

                    </div>
                    <div class="tab-pane fade" id="images" role="tabpanel" aria-labelledby="images-tab">
                        <div class="form-group">
                            <div class="custom-file">
                                <input type="file" class="custom-file-input" id="customFile">
                                <label class="custom-file-label" for="customFile">Upload image</label>
                            </div>
                        </div>
                        <div class="py-4"></div>
                    </div>
                </div>
                <div class="btn-toolbar justify-content-between">
                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">share</button>
                    </div>
                    <div class="btn-group">
                        <select name="visibility" data-style="btn-primary" class="form-control selectpicker"
                            id="visibility">
                            <optgroup label="Visibility">
                                <option data-icon="fa fa-globe">Public</option>
                                <option data-icon="fa fa-users">Friends</option>
                                <option data-icon="fa fa-user">Just me</option>
                            </optgroup>
                        </select>

                        <!-- sorry idk how to make it work w dropdown

                        <button id="btnGroupDrop1" type="button" class="btn btn-link dropdown-toggle"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-globe"></i>
                        </button>

                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="btnGroupDrop1">

                            <a class="dropdown-item" href="#">
                                <i class="fa fa-globe"></i> Public</a>
                            <a class="dropdown-item" href="#">
                                <i class="fa fa-users"></i> Friends</a>
                            <a class="dropdown-item" href="#">
                                <i class="fa fa-user"></i> Just me</a>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
    </form>

    <!-- TODO: if no posts, display a message -->
    {% if not posts: %}
    {% endif %}

    {% for post in posts: %}
    <div class="post container card gedf-card">
        <div class="card-header">
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex justify-content-between align-items-center">
                    {% if post.creator._pic is none %}
                    <div class="mr-2">
                        <img class="rounded-circle" width="45" src="https://picsum.photos/50/50" alt="">
                    </div>
                    {% else %}
                    <div class="mr-2">
                        <img src='{{post.creator.get_img()}}' width="50px" height=auto class="rounded-circle"
                            alt="failed to load">
                    </div>
                    {% endif %}
                    <div class="ml-2">
                        <div class="h5 m-0">
                            <a href='profile/{{ post.creator.uid }}' class="card-link">{{post.creator.firstname}}
                                {{post.creator.lastname}}</a></div>
                    </div>
                </div>
                <div>
                    <div class="dropdown">
                        <button class="btn btn-link dropdown-toggle" type="button" id="gedf-drop1"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-ellipsis-h"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="gedf-drop1">
                            <div class="h6 dropdown-header">Configuration</div>
                            <a class="dropdown-item" href="#">Save</a>
                            <a class="dropdown-item" href="#">Hide</a>
                            <a class="dropdown-item" href="#">Report</a>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="card-body">
            <div class="text-muted h7 mb-2"> <i class="fa fa-clock-o"></i>
                <script type="text/javascript">
                    getTimeAgo("{{ post.date }}");
                </script>
            </div>
            <p class="card-text">
                <img src="{{post.get_img()}}" width="200px">
                {{post.content}}
                {% if post.tags|length %}
                <br>
                <br>
                {% for tag in post.tags: %}
                <button type="button" onclick="location.href='/search?query={{ tag.tid }}'"
                    class="btn btn-primary btn-sm tag-pill">
                    #{{ tag.tid }}
                </button>
                {% endfor %}
                {% endif %}
            </p>
        </div>
        <div class="card-footer">
            {% if user.liked_post(post.pid) %}
            <a href="{{ url_for('post.like', post_id=post.pid, isLike=False) }}" class="card-link">
                <i class="fa fa-heart"></i> {{post.likes|length}}
            </a>
            {% else %}
            <a href="{{ url_for('post.like', post_id=post.pid, isLike=True) }}" class="card-link">
                <i class="fa fa-heart-o"></i> {{post.likes|length}}
            </a>
            {% endif %}
            <a href='post/{{ post.pid }}' class="card-link"><i class="fa fa-comment"></i>
                {{post.get_comments()|length}}</a>
            <a href="#" class="card-link"><i class="fa fa-mail-forward"></i> Share</a>
        </div>
    </div>
    {% endfor %}
    </div>

    <!-- User panel and suggested friends -->
    <div class="col-sm-4">
    </div>


    {% include 'footer.html' %}

    <body>
        <script src="/static/js/jquery.min.js"></script>
        <script src="/static/js/popper.min.js"></script>
        <script src="/static/js/bootstrap.min.js"></script>
        <script src="/static/js/toggle-like.js"></script>
        <script src="/static/js/bootstrap-tagsinput.js"></script>
        <script src="/static/js/disable-input.js"></script>
        <!-- Latest compiled and minified JavaScript -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.12/dist/js/bootstrap-select.min.js"></script>
        <script>
            // Material Select Initialization
            $(document).ready(function () {
                $('.mdb-select').materialSelect();
            });
        </script>
    </body>

</html>
